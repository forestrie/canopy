---
# Deployment orchestration tasks

version: "3"

tasks:
  bootstrap:
    desc: Initial deployment of workers (dev)
    cmds:
      - task: :wrangler:deploy:forestrie-ingress
      - task: :wrangler:deploy:canopy-api
      - task: :wrangler:deploy:delegation-signer

  bootstrap:prod:
    desc: Initial deployment of workers (prod)
    cmds:
      - task: :wrangler:deploy:forestrie-ingress
        vars:
          ENV: prod
      - task: :wrangler:deploy:canopy-api
        vars:
          ENV: prod
      - task: :wrangler:deploy:delegation-signer
        vars:
          ENV: prod

  prod:
    desc: Deploy all workers to production
    cmds:
      - task: :wrangler:deploy:forestrie-ingress
        vars:
          ENV: prod
      - task: :wrangler:deploy:canopy-api
        vars:
          ENV: prod
      - task: :wrangler:deploy:delegation-signer
        vars:
          ENV: prod
